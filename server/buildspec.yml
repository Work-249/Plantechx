version: 0.2
phases:
  install:
    runtime-versions:
      nodejs: 18
    commands:
      - echo "ğŸ“¦ Installing project dependencies (npm ci)..."
      - npm ci
      - echo "ğŸ” Serverless version (local via npx):"
      - npx serverless --version
  pre_build:
    commands:
      - echo "ğŸ§¹ Cleaning previous builds..."
      - rm -rf .serverless
  build:
    commands:
      - echo "ğŸš€ Deploying backend to AWS Lambda using Serverless..."
      - npx serverless deploy --stage prod --region ap-south-1 --verbose
artifacts:
  files:
    - serverless.yml
    - package.json
    - server.js
    - server/**/*
  discard-paths: no
